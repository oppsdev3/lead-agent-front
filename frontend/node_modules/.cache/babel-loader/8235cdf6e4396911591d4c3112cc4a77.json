{"ast":null,"code":"import * as React from 'react';\nimport { getIndex } from '@progress/kendo-react-data-tools';\n/**\n * @hidden\n */\n\nvar CommonDragLogic =\n/** @class */\nfunction () {\n  function CommonDragLogic(columnReorder, groupReorder, columnToGroup) {\n    var _this = this;\n\n    this.refDragElementClue = React.createRef();\n    this.refDropElementClue = React.createRef();\n    this.reorderable = false;\n    this.groupable = false;\n    this.startColumn = -1;\n    this.startGroup = -1;\n    this.currentColumn = -1;\n    this.currentGroup = -1;\n    this.groupPanelDivElement = null;\n\n    this.refGroupPanelDiv = function (e) {\n      _this.groupPanelDivElement = e;\n    };\n\n    this.pressHandler = function (event, element) {\n      var startColumn = _this.getColumnIndex(event, element);\n\n      _this.startGroup = _this.getGroupIndex(event);\n\n      if (startColumn >= 0) {\n        var col = _this.columns[startColumn];\n\n        if (col.reorderable && _this.reorderable || col.groupable && _this.groupable) {\n          _this.startColumn = startColumn;\n        }\n      }\n    };\n\n    this.dragHandler = function (event, element) {\n      if (!event.isTouch) {\n        event.originalEvent.preventDefault();\n      }\n\n      event.originalEvent.stopPropagation();\n\n      if (_this.startColumn === -1 && _this.startGroup === -1) {\n        return;\n      }\n\n      _this.currentColumn = _this.getColumnIndex(event, element);\n      _this.currentGroup = _this.getGroupIndex(event);\n\n      if (_this.groupPanelDivElement && _this.startGroup >= 0) {\n        _this.currentGroup = Math.min(_this.currentGroup, _this.groupPanelDivElement.children.length - 2);\n      }\n\n      var invalidIndex = !_this.isValid();\n\n      if (invalidIndex) {\n        _this.currentColumn = -1;\n        _this.currentGroup = -1;\n      }\n\n      var targetElement = _this.currentColumn >= 0 ? element.children[_this.columns[_this.currentColumn].index] : _this.groupPanelDivElement && _this.groupPanelDivElement.children[_this.currentGroup];\n\n      _this.updateDragElementClue(event, element, targetElement, invalidIndex);\n\n      _this.updateDropElementClue(event, element, targetElement, invalidIndex);\n    };\n\n    this.releaseHandler = function (event) {\n      var prevColumnIndex = _this.startColumn;\n      var nextColumnIndex = _this.currentColumn;\n      var prevGroupIndex = _this.startGroup;\n      var nextGroupIndex = _this.currentGroup;\n      event.originalEvent.preventDefault();\n\n      if (_this.dropElementClue) {\n        _this.dropElementClue.setState({\n          visible: false\n        });\n      }\n\n      if (_this.dragElementClue) {\n        _this.dragElementClue.setState({\n          visible: false\n        });\n      }\n\n      var isValid = _this.isValid();\n\n      _this.startColumn = _this.startGroup = _this.currentColumn = _this.currentGroup = -1;\n\n      if (!isValid) {\n        return;\n      }\n\n      if (prevColumnIndex >= 0 && nextColumnIndex >= 0) {\n        _this.columnReorder(prevColumnIndex, nextColumnIndex, event.originalEvent);\n      } else if (prevGroupIndex >= 0 && nextGroupIndex >= 0) {\n        _this.groupReorder(prevGroupIndex, nextGroupIndex, event.originalEvent);\n      } else if (prevColumnIndex >= 0 && nextGroupIndex >= 0) {\n        _this.columnToGroup(prevColumnIndex, nextGroupIndex, event.originalEvent);\n      }\n    };\n\n    this.columnReorder = columnReorder;\n    this.groupReorder = groupReorder;\n    this.columnToGroup = columnToGroup;\n  }\n\n  Object.defineProperty(CommonDragLogic.prototype, \"dragClueRef\", {\n    get: function () {\n      return this.refDragElementClue;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CommonDragLogic.prototype, \"dropClueRef\", {\n    get: function () {\n      return this.refDropElementClue;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CommonDragLogic.prototype, \"dragElementClue\", {\n    get: function () {\n      return this.refDragElementClue.current;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CommonDragLogic.prototype, \"dropElementClue\", {\n    get: function () {\n      return this.refDropElementClue.current;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  CommonDragLogic.prototype.getColumnIndex = function (event, parent) {\n    if (!parent || parent.parentElement === this.groupPanelDivElement) {\n      return -1;\n    }\n\n    var index = getIndex(event, parent);\n\n    if (index === -1) {\n      return -1;\n    }\n\n    var _loop_1 = function (i) {\n      if (parent.parentNode.children[i] === parent) {\n        return {\n          value: this_1.columns.findIndex(function (c) {\n            return c.index === index && c.depth === i;\n          })\n        };\n      }\n    };\n\n    var this_1 = this;\n\n    for (var i = 0; i < parent.parentNode.children.length; i++) {\n      var state_1 = _loop_1(i);\n\n      if (typeof state_1 === \"object\") return state_1.value;\n    }\n\n    return -1;\n  };\n\n  CommonDragLogic.prototype.getGroupIndex = function (event) {\n    return getIndex(event, this.groupPanelDivElement);\n  };\n\n  CommonDragLogic.prototype.isValid = function () {\n    if (this.startGroup >= 0) {\n      // group can be moved into group only\n      return this.currentGroup >= 0 && this.currentGroup !== this.startGroup;\n    }\n\n    if (this.startColumn === -1) {\n      return false;\n    }\n\n    if (this.currentGroup >= 0) {\n      // column to group is possible\n      return this.columns[this.startColumn].groupable === true && this.groupable === true;\n    } // reorder is possible\n\n\n    return this.reorderable === true && this.currentColumn >= 0 && this.currentColumn !== this.startColumn && this.columns[this.startColumn].reorderable === true && this.columns[this.currentColumn].parentIndex === this.columns[this.startColumn].parentIndex;\n  };\n\n  CommonDragLogic.prototype.updateDragElementClue = function (event, element, targetElement, invalidIndex) {\n    if (!this.dragElementClue) {\n      return;\n    }\n\n    var innerText = this.startColumn >= 0 ? element.children[this.columns[this.startColumn].index].innerText : element.innerText;\n    this.dragElementClue.setState({\n      visible: true,\n      top: event.pageY + 10,\n      left: event.pageX,\n      innerText: innerText,\n      status: invalidIndex || !targetElement ? 'k-i-cancel' : 'k-i-add'\n    });\n  };\n\n  CommonDragLogic.prototype.updateDropElementClue = function (event, element, targetElement, invalidIndex) {\n    if (!this.dropElementClue) {\n      return;\n    }\n\n    if (invalidIndex || !targetElement) {\n      this.dropElementClue.setState({\n        visible: false\n      });\n      return;\n    }\n\n    var rect = targetElement.getBoundingClientRect();\n    var left = rect.left + event.pageX - event.clientX - 6;\n\n    if (this.currentColumn > this.startColumn || this.currentGroup > this.startGroup && this.startGroup !== -1) {\n      left += rect.width;\n    }\n\n    var top = rect.top + event.pageY - event.clientY;\n    this.dropElementClue.setState({\n      visible: true,\n      top: top,\n      left: left,\n      height: this.currentColumn >= 0 ? element.clientHeight : rect.height\n    });\n  };\n\n  return CommonDragLogic;\n}();\n\nexport { CommonDragLogic };","map":{"version":3,"sources":["C:/Users/Admin/LeadManagement/frontend/node_modules/@progress/kendo-react-grid/dist/es/drag/CommonDragLogic.js"],"names":["React","getIndex","CommonDragLogic","columnReorder","groupReorder","columnToGroup","_this","refDragElementClue","createRef","refDropElementClue","reorderable","groupable","startColumn","startGroup","currentColumn","currentGroup","groupPanelDivElement","refGroupPanelDiv","e","pressHandler","event","element","getColumnIndex","getGroupIndex","col","columns","dragHandler","isTouch","originalEvent","preventDefault","stopPropagation","Math","min","children","length","invalidIndex","isValid","targetElement","index","updateDragElementClue","updateDropElementClue","releaseHandler","prevColumnIndex","nextColumnIndex","prevGroupIndex","nextGroupIndex","dropElementClue","setState","visible","dragElementClue","Object","defineProperty","prototype","get","enumerable","configurable","current","parent","parentElement","_loop_1","i","parentNode","value","this_1","findIndex","c","depth","state_1","parentIndex","innerText","top","pageY","left","pageX","status","rect","getBoundingClientRect","clientX","width","clientY","height","clientHeight"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { getIndex } from '@progress/kendo-react-data-tools';\n/**\n * @hidden\n */\nvar CommonDragLogic = /** @class */ (function () {\n    function CommonDragLogic(columnReorder, groupReorder, columnToGroup) {\n        var _this = this;\n        this.refDragElementClue = React.createRef();\n        this.refDropElementClue = React.createRef();\n        this.reorderable = false;\n        this.groupable = false;\n        this.startColumn = -1;\n        this.startGroup = -1;\n        this.currentColumn = -1;\n        this.currentGroup = -1;\n        this.groupPanelDivElement = null;\n        this.refGroupPanelDiv = function (e) {\n            _this.groupPanelDivElement = e;\n        };\n        this.pressHandler = function (event, element) {\n            var startColumn = _this.getColumnIndex(event, element);\n            _this.startGroup = _this.getGroupIndex(event);\n            if (startColumn >= 0) {\n                var col = _this.columns[startColumn];\n                if (col.reorderable && _this.reorderable || col.groupable && _this.groupable) {\n                    _this.startColumn = startColumn;\n                }\n            }\n        };\n        this.dragHandler = function (event, element) {\n            if (!event.isTouch) {\n                event.originalEvent.preventDefault();\n            }\n            event.originalEvent.stopPropagation();\n            if (_this.startColumn === -1 && _this.startGroup === -1) {\n                return;\n            }\n            _this.currentColumn = _this.getColumnIndex(event, element);\n            _this.currentGroup = _this.getGroupIndex(event);\n            if (_this.groupPanelDivElement && _this.startGroup >= 0) {\n                _this.currentGroup = Math.min(_this.currentGroup, _this.groupPanelDivElement.children.length - 2);\n            }\n            var invalidIndex = !_this.isValid();\n            if (invalidIndex) {\n                _this.currentColumn = -1;\n                _this.currentGroup = -1;\n            }\n            var targetElement = (_this.currentColumn >= 0) ?\n                element.children[_this.columns[_this.currentColumn].index] :\n                _this.groupPanelDivElement && _this.groupPanelDivElement.children[_this.currentGroup];\n            _this.updateDragElementClue(event, element, targetElement, invalidIndex);\n            _this.updateDropElementClue(event, element, targetElement, invalidIndex);\n        };\n        this.releaseHandler = function (event) {\n            var prevColumnIndex = _this.startColumn;\n            var nextColumnIndex = _this.currentColumn;\n            var prevGroupIndex = _this.startGroup;\n            var nextGroupIndex = _this.currentGroup;\n            event.originalEvent.preventDefault();\n            if (_this.dropElementClue) {\n                _this.dropElementClue.setState({ visible: false });\n            }\n            if (_this.dragElementClue) {\n                _this.dragElementClue.setState({ visible: false });\n            }\n            var isValid = _this.isValid();\n            _this.startColumn = _this.startGroup = _this.currentColumn = _this.currentGroup = -1;\n            if (!isValid) {\n                return;\n            }\n            if (prevColumnIndex >= 0 && nextColumnIndex >= 0) {\n                _this.columnReorder(prevColumnIndex, nextColumnIndex, event.originalEvent);\n            }\n            else if (prevGroupIndex >= 0 && nextGroupIndex >= 0) {\n                _this.groupReorder(prevGroupIndex, nextGroupIndex, event.originalEvent);\n            }\n            else if (prevColumnIndex >= 0 && nextGroupIndex >= 0) {\n                _this.columnToGroup(prevColumnIndex, nextGroupIndex, event.originalEvent);\n            }\n        };\n        this.columnReorder = columnReorder;\n        this.groupReorder = groupReorder;\n        this.columnToGroup = columnToGroup;\n    }\n    Object.defineProperty(CommonDragLogic.prototype, \"dragClueRef\", {\n        get: function () {\n            return this.refDragElementClue;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CommonDragLogic.prototype, \"dropClueRef\", {\n        get: function () {\n            return this.refDropElementClue;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CommonDragLogic.prototype, \"dragElementClue\", {\n        get: function () {\n            return this.refDragElementClue.current;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(CommonDragLogic.prototype, \"dropElementClue\", {\n        get: function () {\n            return this.refDropElementClue.current;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    CommonDragLogic.prototype.getColumnIndex = function (event, parent) {\n        if (!parent || (parent.parentElement === this.groupPanelDivElement)) {\n            return -1;\n        }\n        var index = getIndex(event, parent);\n        if (index === -1) {\n            return -1;\n        }\n        var _loop_1 = function (i) {\n            if (parent.parentNode.children[i] === parent) {\n                return { value: this_1.columns.findIndex(function (c) { return ((c.index === index) && (c.depth === i)); }) };\n            }\n        };\n        var this_1 = this;\n        for (var i = 0; i < parent.parentNode.children.length; i++) {\n            var state_1 = _loop_1(i);\n            if (typeof state_1 === \"object\")\n                return state_1.value;\n        }\n        return -1;\n    };\n    CommonDragLogic.prototype.getGroupIndex = function (event) {\n        return getIndex(event, this.groupPanelDivElement);\n    };\n    CommonDragLogic.prototype.isValid = function () {\n        if (this.startGroup >= 0) {\n            // group can be moved into group only\n            return this.currentGroup >= 0 && this.currentGroup !== this.startGroup;\n        }\n        if (this.startColumn === -1) {\n            return false;\n        }\n        if (this.currentGroup >= 0) {\n            // column to group is possible\n            return this.columns[this.startColumn].groupable === true && this.groupable === true;\n        }\n        // reorder is possible\n        return this.reorderable === true &&\n            this.currentColumn >= 0 &&\n            this.currentColumn !== this.startColumn &&\n            this.columns[this.startColumn].reorderable === true &&\n            this.columns[this.currentColumn].parentIndex === this.columns[this.startColumn].parentIndex;\n    };\n    CommonDragLogic.prototype.updateDragElementClue = function (event, element, targetElement, invalidIndex) {\n        if (!this.dragElementClue) {\n            return;\n        }\n        var innerText = this.startColumn >= 0 ?\n            element.children[this.columns[this.startColumn].index].innerText :\n            element.innerText;\n        this.dragElementClue.setState({\n            visible: true,\n            top: (event.pageY + 10),\n            left: event.pageX,\n            innerText: innerText,\n            status: (invalidIndex || !targetElement) ? 'k-i-cancel' : 'k-i-add'\n        });\n    };\n    CommonDragLogic.prototype.updateDropElementClue = function (event, element, targetElement, invalidIndex) {\n        if (!this.dropElementClue) {\n            return;\n        }\n        if (invalidIndex || !targetElement) {\n            this.dropElementClue.setState({ visible: false });\n            return;\n        }\n        var rect = targetElement.getBoundingClientRect();\n        var left = rect.left + event.pageX - event.clientX - 6;\n        if (this.currentColumn > this.startColumn || this.currentGroup > this.startGroup && this.startGroup !== -1) {\n            left += rect.width;\n        }\n        var top = rect.top + event.pageY - event.clientY;\n        this.dropElementClue.setState({\n            visible: true,\n            top: top,\n            left: left,\n            height: (this.currentColumn >= 0) ? element.clientHeight : rect.height\n        });\n    };\n    return CommonDragLogic;\n}());\nexport { CommonDragLogic };\n"]},"metadata":{},"sourceType":"module"}