{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport * as React from 'react';\nimport { GridColumnMenuItem } from './GridColumnMenuItem';\nimport { GridColumnMenuItemGroup } from './GridColumnMenuItemGroup';\nimport { GridColumnMenuItemContent } from './GridColumnMenuItemContent';\nimport { Checkbox, Input } from '@progress/kendo-react-inputs';\nimport { provideLocalizationService, registerForLocalization } from '@progress/kendo-react-intl';\nimport { messages, filterClearButton, filterSubmitButton, filterTitle, searchPlaceholder, filterCheckAll, filterSelectedItems } from '../messages';\nimport { filterBy } from '@progress/kendo-data-query';\nimport { clone } from '@progress/kendo-react-common';\nimport { Button } from '@progress/kendo-react-buttons';\nimport { getNestedValue } from '../utils';\n/**\n * @hidden\n */\n\nvar isArrayEqual = function (firstArray, secondArray) {\n  if (firstArray.length !== secondArray.length) {\n    return false;\n  }\n\n  return firstArray.every(function (ex, i) {\n    return ex === secondArray[i];\n  });\n};\n\nvar GridColumnMenuCheckboxFilter =\n/** @class */\nfunction (_super) {\n  __extends(GridColumnMenuCheckboxFilter, _super);\n\n  function GridColumnMenuCheckboxFilter(props) {\n    var _this = _super.call(this, props) || this;\n    /**\n     * @hidden\n     */\n\n\n    _this.defaultFilter = function () {\n      if (_this.props.filter) {\n        return clone(_this.props.filter);\n      }\n\n      return {\n        filters: [],\n        logic: 'and'\n      };\n    };\n    /**\n     * @hidden\n     */\n\n\n    _this.isControlled = function () {\n      return _this.props.expanded !== undefined;\n    };\n    /**\n     * @hidden\n     */\n\n\n    _this.parseData = function (originalData, isUnique) {\n      var field = _this.props.column.field || '';\n      var data = originalData.map(function (item) {\n        return getNestedValue(field, item);\n      });\n\n      if (isUnique) {\n        return data.filter(function (item, index) {\n          return data.indexOf(item) === index;\n        });\n      }\n\n      return data;\n    };\n    /**\n     * @hidden\n     */\n\n\n    _this.getFilterIndex = function () {\n      var field = _this.props.column.field;\n\n      var currentFilter = _this.defaultFilter();\n\n      var compositeFilterIndex = currentFilter.filters.findIndex(function (filter) {\n        return filter.filters && filter.filters.length > 0 && filter.filters[0].field === field;\n      });\n      return compositeFilterIndex;\n    };\n    /**\n     * @hidden\n     */\n\n\n    _this.onFilterExpand = function () {\n      var isControlled = _this.isControlled();\n\n      var nextValue = !(isControlled ? _this.props.expanded : _this.state.expanded);\n\n      if (_this.props.onExpandChange) {\n        _this.props.onExpandChange(nextValue);\n      }\n\n      if (!isControlled) {\n        _this.setState({\n          expanded: nextValue\n        });\n      }\n    };\n    /**\n     * @hidden\n     */\n\n\n    _this.handleSearchChange = function (e) {\n      var filterOperator = _this.props.searchBoxFilterOperator ? _this.props.searchBoxFilterOperator : 'startswith';\n      var filterExpression = {\n        logic: 'and',\n        filters: [{\n          field: _this.props.column.field,\n          operator: filterOperator,\n          value: e.target.value,\n          ignoreCase: true\n        }]\n      };\n\n      _this.setState({\n        value: e.target.value,\n        data: _this.parseData(filterBy(_this.props.data || [], filterExpression), _this.props.uniqueData)\n      });\n    };\n    /**\n     * @hidden\n     */\n\n\n    _this.handleClear = function () {\n      var filterOperator = _this.props.searchBoxFilterOperator ? _this.props.searchBoxFilterOperator : 'startswith';\n      var filterExpression = {\n        logic: 'and',\n        filters: [{\n          field: _this.props.column.field,\n          operator: filterOperator,\n          value: '',\n          ignoreCase: true\n        }]\n      };\n\n      _this.setState({\n        value: '',\n        data: _this.parseData(filterBy(_this.props.data || [], filterExpression), _this.props.uniqueData)\n      });\n    };\n    /**\n     * @hidden\n     */\n\n\n    _this.clear = function (e) {\n      e.preventDefault();\n\n      if (!_this.props.onFilterChange) {\n        return;\n      }\n\n      var updatedFilter = _this.state.currentFilter || null;\n\n      if (updatedFilter !== null && updatedFilter.filters.length > 0) {\n        if (_this.compositeFilterIndex >= 0) {\n          updatedFilter.filters.splice(_this.compositeFilterIndex, 1);\n        }\n\n        _this.props.onFilterChange(updatedFilter, e);\n      } else {\n        _this.props.onFilterChange(null, e);\n      }\n\n      if (_this.props.onCloseMenu) {\n        _this.props.onCloseMenu();\n      }\n    };\n    /**\n     * @hidden\n     */\n\n\n    _this.submit = function (e) {\n      e.preventDefault();\n\n      if (!_this.props.onFilterChange) {\n        return;\n      }\n\n      var updatedFilter = _this.state.currentFilter || null;\n\n      _this.props.onFilterChange(updatedFilter, e);\n\n      if (_this.props.onCloseMenu) {\n        _this.props.onCloseMenu();\n      }\n    };\n    /**\n     * @hidden\n     */\n\n\n    _this.handleCheckBoxChange = function (e, value) {\n      var field = _this.props.column.field || '';\n\n      var newFilter = __assign({}, _this.state.currentFilter);\n\n      var filters = _this.state.currentFilter.filters.slice() || [];\n      var fieldFilters = [];\n\n      if (_this.compositeFilterIndex !== -1 && newFilter.filters[_this.compositeFilterIndex].filters && value !== 'all') {\n        fieldFilters = newFilter.filters[_this.compositeFilterIndex].filters;\n      }\n\n      if (e.value && value === 'all') {\n        _this.state.data.forEach(function (item) {\n          fieldFilters.push({\n            field: field,\n            operator: 'eq',\n            value: item\n          });\n        });\n      } else if (e.value) {\n        fieldFilters.push({\n          field: field,\n          operator: 'eq',\n          value: value\n        });\n      } else if (_this.state.currentFilter) {\n        var index = fieldFilters.findIndex(function (filter) {\n          return filter.value === value;\n        });\n        fieldFilters.splice(index, 1);\n      }\n\n      newFilter.logic = 'and';\n\n      if (_this.compositeFilterIndex !== -1) {\n        filters[_this.compositeFilterIndex] = {\n          logic: 'or',\n          filters: fieldFilters\n        };\n      } else {\n        filters.push({\n          logic: 'or',\n          filters: fieldFilters\n        });\n      }\n\n      if (!e.value && value === 'all' || fieldFilters.length === 0) {\n        filters.splice(_this.compositeFilterIndex, 1);\n      }\n\n      newFilter.filters = filters;\n\n      _this.setState({\n        currentFilter: newFilter\n      });\n    };\n    /**\n     * @hidden\n     */\n\n\n    _this.isAllSelected = function () {\n      var isAllChecked = false;\n\n      if (_this.state.currentFilter) {\n        var filters_1 = _this.state.currentFilter.filters.slice();\n\n        if (_this.compositeFilterIndex === -1) {\n          return false;\n        }\n\n        isAllChecked = _this.state.data.every(function (item) {\n          if (_this.compositeFilterIndex !== -1 && filters_1[_this.compositeFilterIndex].filters) {\n            var index = filters_1[_this.compositeFilterIndex].filters.findIndex(function (filter) {\n              return filter.value === item;\n            });\n\n            return index >= 0;\n          }\n\n          return false;\n        });\n        return isAllChecked;\n      }\n\n      return isAllChecked;\n    };\n\n    _this.compositeFilterIndex = _this.getFilterIndex();\n    _this.state = {\n      expanded: props.expanded || false,\n      value: '',\n      data: _this.parseData(_this.props.data, _this.props.uniqueData) || [],\n      dataFromProps: _this.parseData(_this.props.data, false) || [],\n      currentFilter: _this.defaultFilter()\n    };\n    return _this;\n  }\n  /**\n   * @hidden\n   */\n\n\n  GridColumnMenuCheckboxFilter.prototype.componentDidUpdate = function () {\n    var field = this.props.column.field || '';\n    var data = this.props.data.map(function (item) {\n      return getNestedValue(field, item);\n    });\n\n    if (!isArrayEqual(data, this.state.dataFromProps)) {\n      this.setState({\n        data: data,\n        dataFromProps: data\n      });\n    }\n  };\n  /**\n   * @hidden\n   */\n\n\n  GridColumnMenuCheckboxFilter.prototype.render = function () {\n    var _this = this;\n\n    var column = this.props.column;\n\n    if (!column || !column.field) {\n      return React.createElement(\"div\", null);\n    }\n\n    var localizationService = provideLocalizationService(this);\n    var expandState = this.isControlled() ? this.props.expanded : this.state.expanded;\n    var filterValues = [];\n\n    if (this.state.currentFilter) {\n      var currentFilter = this.state.currentFilter.filters.slice();\n      this.compositeFilterIndex = currentFilter.findIndex(function (filter) {\n        if (filter.filters && filter.filters.length > 0) {\n          return filter.filters[0].field === column.field;\n        }\n\n        return false;\n      });\n\n      if (this.compositeFilterIndex !== -1 && currentFilter[this.compositeFilterIndex].filters.length > 0) {\n        currentFilter[this.compositeFilterIndex].filters.forEach(function (filterItem) {\n          if (filterItem.field === _this.props.column.field) {\n            filterValues.push(filterItem.value);\n          }\n        });\n      }\n    }\n\n    var searchBox = this.props.searchBox ? React.createElement(this.props.searchBox, {\n      value: this.state.value,\n      onChange: this.handleSearchChange\n    }) : React.createElement(\"div\", {\n      className: \"k-searchbox k-textbox k-input k-input-md k-input-solid\"\n    }, React.createElement(\"span\", {\n      className: \"k-input-icon k-icon k-i-search\"\n    }), React.createElement(Input, {\n      className: \"k-input-inner\",\n      type: \"text\",\n      placeholder: localizationService.toLanguageString(searchPlaceholder, messages[searchPlaceholder]),\n      value: this.state.value,\n      onChange: function (e) {\n        return _this.handleSearchChange(e.nativeEvent);\n      }\n    }), React.createElement(Button, {\n      type: \"button\",\n      rounded: null,\n      className: \"k-input-button\",\n      onClick: this.handleClear,\n      icon: \"close\"\n    }));\n    var uniqueFilterValues = filterValues.filter(function (item, index) {\n      return filterValues.indexOf(item) === index;\n    });\n    return React.createElement(GridColumnMenuItemGroup, null, React.createElement(GridColumnMenuItem, {\n      title: localizationService.toLanguageString(filterTitle, messages[filterTitle]),\n      iconClass: \"k-i-filter\",\n      onClick: this.onFilterExpand\n    }), React.createElement(GridColumnMenuItemContent, {\n      show: !!expandState\n    }, React.createElement(\"div\", {\n      className: \"kendo-grid-filter-menu-container\"\n    }, React.createElement(\"form\", {\n      className: \"k-filter-menu k-group k-reset k-state-border-up\",\n      onSubmit: this.submit,\n      onReset: this.clear\n    }, React.createElement(\"div\", {\n      className: \"k-filter-menu-container\"\n    }, searchBox, React.createElement(\"ul\", {\n      className: \"k-reset k-multicheck-wrap\"\n    }, React.createElement(\"li\", {\n      className: \"k-item k-check-all-wrap\"\n    }, React.createElement(Checkbox, {\n      label: localizationService.toLanguageString(filterCheckAll, messages[filterCheckAll]),\n      onChange: function (e) {\n        return _this.handleCheckBoxChange(e, 'all');\n      },\n      checked: this.isAllSelected()\n    })), this.state.data.map(function (item, index) {\n      return React.createElement(\"li\", {\n        className: \"k-item\",\n        key: index\n      }, React.createElement(Checkbox, {\n        label: String(item),\n        onChange: function (e) {\n          return _this.handleCheckBoxChange(e, item);\n        },\n        checked: uniqueFilterValues.includes(item)\n      }));\n    })), React.createElement(\"div\", {\n      className: \"k-filter-selected-items\"\n    }, uniqueFilterValues.length + ' ' + localizationService.toLanguageString(filterSelectedItems, messages[filterSelectedItems])), React.createElement(\"div\", {\n      className: \"k-actions k-hstack k-justify-content-stretch\"\n    }, React.createElement(Button, {\n      themeColor: \"primary\",\n      type: 'submit'\n    }, localizationService.toLanguageString(filterSubmitButton, messages[filterSubmitButton])), React.createElement(Button, {\n      className: \"k-button\",\n      type: 'reset'\n    }, localizationService.toLanguageString(filterClearButton, messages[filterClearButton]))))))));\n  };\n  /**\n   * @hidden\n   */\n\n\n  GridColumnMenuCheckboxFilter.defaultProps = {\n    uniqueData: true\n  };\n  return GridColumnMenuCheckboxFilter;\n}(React.Component);\n\nexport { GridColumnMenuCheckboxFilter };\nregisterForLocalization(GridColumnMenuCheckboxFilter);","map":{"version":3,"sources":["C:/Users/Admin/LeadManagement/frontend/node_modules/@progress/kendo-react-grid/dist/es/columnMenu/GridColumnMenuCheckboxFilter.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","React","GridColumnMenuItem","GridColumnMenuItemGroup","GridColumnMenuItemContent","Checkbox","Input","provideLocalizationService","registerForLocalization","messages","filterClearButton","filterSubmitButton","filterTitle","searchPlaceholder","filterCheckAll","filterSelectedItems","filterBy","clone","Button","getNestedValue","isArrayEqual","firstArray","secondArray","every","ex","GridColumnMenuCheckboxFilter","_super","props","_this","defaultFilter","filter","filters","logic","isControlled","expanded","undefined","parseData","originalData","isUnique","field","column","data","map","item","index","indexOf","getFilterIndex","currentFilter","compositeFilterIndex","findIndex","onFilterExpand","nextValue","state","onExpandChange","setState","handleSearchChange","e","filterOperator","searchBoxFilterOperator","filterExpression","operator","value","target","ignoreCase","uniqueData","handleClear","clear","preventDefault","onFilterChange","updatedFilter","splice","onCloseMenu","submit","handleCheckBoxChange","newFilter","slice","fieldFilters","forEach","push","isAllSelected","isAllChecked","filters_1","dataFromProps","componentDidUpdate","render","createElement","localizationService","expandState","filterValues","filterItem","searchBox","onChange","className","type","placeholder","toLanguageString","nativeEvent","rounded","onClick","icon","uniqueFilterValues","title","iconClass","show","onSubmit","onReset","label","checked","key","String","includes","themeColor","defaultProps","Component"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport * as React from 'react';\nimport { GridColumnMenuItem } from './GridColumnMenuItem';\nimport { GridColumnMenuItemGroup } from './GridColumnMenuItemGroup';\nimport { GridColumnMenuItemContent } from './GridColumnMenuItemContent';\nimport { Checkbox, Input } from '@progress/kendo-react-inputs';\nimport { provideLocalizationService, registerForLocalization } from '@progress/kendo-react-intl';\nimport { messages, filterClearButton, filterSubmitButton, filterTitle, searchPlaceholder, filterCheckAll, filterSelectedItems } from '../messages';\nimport { filterBy } from '@progress/kendo-data-query';\nimport { clone } from '@progress/kendo-react-common';\nimport { Button } from '@progress/kendo-react-buttons';\nimport { getNestedValue } from '../utils';\n/**\n * @hidden\n */\nvar isArrayEqual = function (firstArray, secondArray) {\n    if (firstArray.length !== secondArray.length) {\n        return false;\n    }\n    return firstArray.every(function (ex, i) { return ex === secondArray[i]; });\n};\nvar GridColumnMenuCheckboxFilter = /** @class */ (function (_super) {\n    __extends(GridColumnMenuCheckboxFilter, _super);\n    function GridColumnMenuCheckboxFilter(props) {\n        var _this = _super.call(this, props) || this;\n        /**\n         * @hidden\n         */\n        _this.defaultFilter = function () {\n            if (_this.props.filter) {\n                return clone(_this.props.filter);\n            }\n            return { filters: [], logic: 'and' };\n        };\n        /**\n         * @hidden\n         */\n        _this.isControlled = function () { return _this.props.expanded !== undefined; };\n        /**\n         * @hidden\n         */\n        _this.parseData = function (originalData, isUnique) {\n            var field = _this.props.column.field || '';\n            var data = originalData.map(function (item) { return getNestedValue(field, item); });\n            if (isUnique) {\n                return data.filter(function (item, index) { return data.indexOf(item) === index; });\n            }\n            return data;\n        };\n        /**\n         * @hidden\n         */\n        _this.getFilterIndex = function () {\n            var field = _this.props.column.field;\n            var currentFilter = _this.defaultFilter();\n            var compositeFilterIndex = currentFilter.filters.findIndex(function (filter) {\n                return filter.filters && filter.filters.length > 0 && filter.filters[0].field === field;\n            });\n            return compositeFilterIndex;\n        };\n        /**\n         * @hidden\n         */\n        _this.onFilterExpand = function () {\n            var isControlled = _this.isControlled();\n            var nextValue = !(isControlled ? _this.props.expanded : _this.state.expanded);\n            if (_this.props.onExpandChange) {\n                _this.props.onExpandChange(nextValue);\n            }\n            if (!isControlled) {\n                _this.setState({\n                    expanded: nextValue\n                });\n            }\n        };\n        /**\n         * @hidden\n         */\n        _this.handleSearchChange = function (e) {\n            var filterOperator = _this.props.searchBoxFilterOperator ? _this.props.searchBoxFilterOperator : 'startswith';\n            var filterExpression = {\n                logic: 'and',\n                filters: [\n                    { field: _this.props.column.field, operator: filterOperator, value: e.target.value, ignoreCase: true }\n                ]\n            };\n            _this.setState({\n                value: e.target.value,\n                data: _this.parseData(filterBy(_this.props.data || [], filterExpression), _this.props.uniqueData)\n            });\n        };\n        /**\n         * @hidden\n         */\n        _this.handleClear = function () {\n            var filterOperator = _this.props.searchBoxFilterOperator ? _this.props.searchBoxFilterOperator : 'startswith';\n            var filterExpression = {\n                logic: 'and',\n                filters: [\n                    { field: _this.props.column.field, operator: filterOperator, value: '', ignoreCase: true }\n                ]\n            };\n            _this.setState({\n                value: '',\n                data: _this.parseData(filterBy(_this.props.data || [], filterExpression), _this.props.uniqueData)\n            });\n        };\n        /**\n         * @hidden\n         */\n        _this.clear = function (e) {\n            e.preventDefault();\n            if (!_this.props.onFilterChange) {\n                return;\n            }\n            var updatedFilter = _this.state.currentFilter || null;\n            if (updatedFilter !== null && updatedFilter.filters.length > 0) {\n                if (_this.compositeFilterIndex >= 0) {\n                    updatedFilter.filters.splice(_this.compositeFilterIndex, 1);\n                }\n                _this.props.onFilterChange(updatedFilter, e);\n            }\n            else {\n                _this.props.onFilterChange(null, e);\n            }\n            if (_this.props.onCloseMenu) {\n                _this.props.onCloseMenu();\n            }\n        };\n        /**\n         * @hidden\n         */\n        _this.submit = function (e) {\n            e.preventDefault();\n            if (!_this.props.onFilterChange) {\n                return;\n            }\n            var updatedFilter = _this.state.currentFilter || null;\n            _this.props.onFilterChange(updatedFilter, e);\n            if (_this.props.onCloseMenu) {\n                _this.props.onCloseMenu();\n            }\n        };\n        /**\n         * @hidden\n         */\n        _this.handleCheckBoxChange = function (e, value) {\n            var field = _this.props.column.field || '';\n            var newFilter = __assign({}, _this.state.currentFilter);\n            var filters = _this.state.currentFilter.filters.slice() || [];\n            var fieldFilters = [];\n            if (_this.compositeFilterIndex !== -1 && newFilter.filters[_this.compositeFilterIndex].filters && value !== 'all') {\n                fieldFilters = newFilter.filters[_this.compositeFilterIndex].filters;\n            }\n            if (e.value && value === 'all') {\n                _this.state.data.forEach(function (item) {\n                    fieldFilters.push({ field: field, operator: 'eq', value: item });\n                });\n            }\n            else if (e.value) {\n                fieldFilters.push({ field: field, operator: 'eq', value: value });\n            }\n            else if (_this.state.currentFilter) {\n                var index = fieldFilters.findIndex(function (filter) { return filter.value === value; });\n                fieldFilters.splice(index, 1);\n            }\n            newFilter.logic = 'and';\n            if (_this.compositeFilterIndex !== -1) {\n                filters[_this.compositeFilterIndex] = {\n                    logic: 'or',\n                    filters: fieldFilters\n                };\n            }\n            else {\n                filters.push({\n                    logic: 'or',\n                    filters: fieldFilters\n                });\n            }\n            if (!e.value && value === 'all' || fieldFilters.length === 0) {\n                filters.splice(_this.compositeFilterIndex, 1);\n            }\n            newFilter.filters = filters;\n            _this.setState({ currentFilter: newFilter });\n        };\n        /**\n         * @hidden\n         */\n        _this.isAllSelected = function () {\n            var isAllChecked = false;\n            if (_this.state.currentFilter) {\n                var filters_1 = _this.state.currentFilter.filters.slice();\n                if (_this.compositeFilterIndex === -1) {\n                    return false;\n                }\n                isAllChecked = _this.state.data.every(function (item) {\n                    if (_this.compositeFilterIndex !== -1 && filters_1[_this.compositeFilterIndex].filters) {\n                        var index = filters_1[_this.compositeFilterIndex].filters.findIndex(function (filter) { return filter.value === item; });\n                        return index >= 0;\n                    }\n                    return false;\n                });\n                return isAllChecked;\n            }\n            return isAllChecked;\n        };\n        _this.compositeFilterIndex = _this.getFilterIndex();\n        _this.state = {\n            expanded: props.expanded || false,\n            value: '',\n            data: _this.parseData(_this.props.data, _this.props.uniqueData) || [],\n            dataFromProps: _this.parseData(_this.props.data, false) || [],\n            currentFilter: _this.defaultFilter()\n        };\n        return _this;\n    }\n    /**\n     * @hidden\n     */\n    GridColumnMenuCheckboxFilter.prototype.componentDidUpdate = function () {\n        var field = this.props.column.field || '';\n        var data = this.props.data.map(function (item) { return getNestedValue(field, item); });\n        if (!isArrayEqual(data, this.state.dataFromProps)) {\n            this.setState({\n                data: data,\n                dataFromProps: data\n            });\n        }\n    };\n    /**\n     * @hidden\n     */\n    GridColumnMenuCheckboxFilter.prototype.render = function () {\n        var _this = this;\n        var column = this.props.column;\n        if (!column || !column.field) {\n            return React.createElement(\"div\", null);\n        }\n        var localizationService = provideLocalizationService(this);\n        var expandState = this.isControlled() ? this.props.expanded : this.state.expanded;\n        var filterValues = [];\n        if (this.state.currentFilter) {\n            var currentFilter = this.state.currentFilter.filters.slice();\n            this.compositeFilterIndex = currentFilter.findIndex(function (filter) {\n                if (filter.filters && filter.filters.length > 0) {\n                    return filter.filters[0].field === column.field;\n                }\n                return false;\n            });\n            if (this.compositeFilterIndex !== -1 && currentFilter[this.compositeFilterIndex].filters.length > 0) {\n                currentFilter[this.compositeFilterIndex].filters.forEach(function (filterItem) {\n                    if (filterItem.field === _this.props.column.field) {\n                        filterValues.push(filterItem.value);\n                    }\n                });\n            }\n        }\n        var searchBox = this.props.searchBox ?\n            React.createElement(this.props.searchBox, { value: this.state.value, onChange: this.handleSearchChange }) :\n            (React.createElement(\"div\", { className: \"k-searchbox k-textbox k-input k-input-md k-input-solid\" },\n                React.createElement(\"span\", { className: \"k-input-icon k-icon k-i-search\" }),\n                React.createElement(Input, { className: \"k-input-inner\", type: \"text\", placeholder: localizationService.toLanguageString(searchPlaceholder, messages[searchPlaceholder]), value: this.state.value, onChange: function (e) { return _this.handleSearchChange(e.nativeEvent); } }),\n                React.createElement(Button, { type: \"button\", rounded: null, className: \"k-input-button\", onClick: this.handleClear, icon: \"close\" })));\n        var uniqueFilterValues = filterValues.filter(function (item, index) { return filterValues.indexOf(item) === index; });\n        return (React.createElement(GridColumnMenuItemGroup, null,\n            React.createElement(GridColumnMenuItem, { title: localizationService.toLanguageString(filterTitle, messages[filterTitle]), iconClass: \"k-i-filter\", onClick: this.onFilterExpand }),\n            React.createElement(GridColumnMenuItemContent, { show: !!expandState },\n                React.createElement(\"div\", { className: \"kendo-grid-filter-menu-container\" },\n                    React.createElement(\"form\", { className: \"k-filter-menu k-group k-reset k-state-border-up\", onSubmit: this.submit, onReset: this.clear },\n                        React.createElement(\"div\", { className: \"k-filter-menu-container\" },\n                            searchBox,\n                            React.createElement(\"ul\", { className: \"k-reset k-multicheck-wrap\" },\n                                React.createElement(\"li\", { className: \"k-item k-check-all-wrap\" },\n                                    React.createElement(Checkbox, { label: localizationService.toLanguageString(filterCheckAll, messages[filterCheckAll]), onChange: function (e) { return _this.handleCheckBoxChange(e, 'all'); }, checked: this.isAllSelected() })),\n                                this.state.data.map(function (item, index) {\n                                    return (React.createElement(\"li\", { className: \"k-item\", key: index },\n                                        React.createElement(Checkbox, { label: String(item), onChange: function (e) { return _this.handleCheckBoxChange(e, item); }, checked: uniqueFilterValues.includes(item) })));\n                                })),\n                            React.createElement(\"div\", { className: \"k-filter-selected-items\" }, uniqueFilterValues.length + ' ' + localizationService.toLanguageString(filterSelectedItems, messages[filterSelectedItems])),\n                            React.createElement(\"div\", { className: \"k-actions k-hstack k-justify-content-stretch\" },\n                                React.createElement(Button, { themeColor: \"primary\", type: 'submit' }, localizationService.toLanguageString(filterSubmitButton, messages[filterSubmitButton])),\n                                React.createElement(Button, { className: \"k-button\", type: 'reset' }, localizationService.toLanguageString(filterClearButton, messages[filterClearButton])))))))));\n    };\n    /**\n     * @hidden\n     */\n    GridColumnMenuCheckboxFilter.defaultProps = {\n        uniqueData: true\n    };\n    return GridColumnMenuCheckboxFilter;\n}(React.Component));\nexport { GridColumnMenuCheckboxFilter };\nregisterForLocalization(GridColumnMenuCheckboxFilter);\n"]},"metadata":{},"sourceType":"module"}