const fs = require('fs')
const chalk = require('chalk')
const path = require('path')

const packageJsonStats = ({
  basePath = process.cwd()
} = {}) => {
  const packageJsonPath = path.resolve(basePath, 'package.json')
  if (!fs.existsSync(packageJsonPath)) {
    console.error(chalk.red.bold(`❯ 💣 ${packageJsonPath} does not exist!`))
    process.exit(1)
  }

  const packageJson = require(packageJsonPath)

  // Transform package name to CamelCase.
  const pascalCase = packageJson.
    name.
    split(/[^A-Za-z0-9]+/).
    reduce(
      (PascalCase, word) => (
        PascalCase + word.replace(/^([a-z])/, g => g[0].toUpperCase())
      ),
      ''
    )

  return({
    name: packageJson.name,
    version: packageJson.version,
    namePascalCase: pascalCase,
  })
}

module.exports = packageJsonStats
