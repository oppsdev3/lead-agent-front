module.exports = ({
  mediaFile = 'assets/media/[name].[hash:8].[ext]',
  mediaInlineLimit = 10000,
  mediaFileExtension = [/\.bmp$/, /\.gif$/, /\.jpe?g$/, /\.png$/]
}) => config => {
  config.module.rules[0].oneOf = [
    {
      test: mediaFileExtension,
      loader: require.resolve('url-loader'),
      options: {
        limit: mediaInlineLimit,
        name: mediaFile,
      },
    }
  ].concat(config.module.rules[0].oneOf)

  config.module.rules[0].oneOf = config.module.rules[0].oneOf.concat([
    {
      loader: require.resolve('file-loader'),
      exclude: [/\.jsx?$/, /\.html$/, /\.json$/],
      options: {
        name: mediaFile,
      },
    }
  ])

  return(config)
}
